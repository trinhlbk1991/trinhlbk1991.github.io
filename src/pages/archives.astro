---
import ArchivesPage from '../components/pages/ArchivesPage.astro';
import { getCollection } from 'astro:content';
import { SITE } from '../config';

const posts = await getCollection('blog');

// Group posts by year
const postsByYear = posts
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf())
  .reduce((acc, post) => {
    const year = post.data.date.getFullYear();
    if (!acc[year]) {
      acc[year] = [];
    }
    acc[year].push(post);
    return acc;
  }, {} as Record<number, typeof posts>);

const years = Object.keys(postsByYear).map(Number).sort((a, b) => b - a);
---

<ArchivesPage lang="en" />