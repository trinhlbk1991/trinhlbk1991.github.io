---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

const posts = await getCollection('blog');
const latestPosts = posts
  .sort((a, b) => b.data.publishedAt.valueOf() - a.data.publishedAt.valueOf())
  .slice(0, 3);
---

<BaseLayout title="Home" description="Gastronaut - A food blog for the curious cook">
  <div class="relative overflow-hidden">
    <!-- Decorative background element -->
    <div class="absolute -top-24 -right-24 w-96 h-96 bg-primary-light rounded-full blur-3xl opacity-50 -z-10"></div>
    
    <div class="max-w-5xl mx-auto px-6 py-24 lg:py-32">
      <!-- Hero -->
      <section class="text-center mb-24 relative">
        <span class="text-primary font-medium tracking-wider uppercase text-sm mb-4 block">Welcome to Gastronaut</span>
        <h1 class="text-display-xl md:text-display-2xl text-content mb-6 font-serif">
          Culinary <span class="italic text-primary">Adventures</span><br />
          for the Curious Cook
        </h1>
        <p class="text-body-l text-content-muted max-w-2xl mx-auto mb-10">
          Explore a collection of recipes, techniques, and stories from the kitchen. 
          From simple weeknight dinners to elaborate weekend projects.
        </p>
        <div class="flex justify-center gap-4">
          <a href="/blog" class="btn-primary inline-flex items-center gap-2">
            Browse Recipes
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
            </svg>
          </a>
          <a href="/about" class="btn-secondary">
            Our Story
          </a>
        </div>
      </section>
  
      <!-- Latest Posts -->
      {latestPosts.length > 0 && (
        <section>
          <div class="flex items-end justify-between mb-10">
            <h2 class="text-heading-l text-content">Latest Recipes</h2>
            <a href="/blog" class="text-primary font-medium hover:text-primary-hover transition-colors flex items-center gap-1">
              View all 
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
            </a>
          </div>
          
          <div class="grid gap-8 sm:grid-cols-2 lg:grid-cols-3">
            {latestPosts.map((post) => (
              <a 
                href={`/blog/${post.slug}`}
                class="card group block overflow-hidden"
              >
                <div class="aspect-[4/3] bg-stone-200 relative overflow-hidden">
                  {post.data.image ? (
                    <img 
                      src={post.data.image} 
                      alt={post.data.imageAlt || post.data.title}
                      class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"
                    />
                  ) : (
                    <div class="absolute inset-0 bg-stone-300 flex items-center justify-center text-stone-400">
                      <svg class="w-12 h-12 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" /></svg>
                    </div>
                  )}
                </div>
                <div class="p-6">
                  <span class="text-caption text-primary mb-2 block">{post.data.category}</span>
                  <h3 class="text-heading-m text-content group-hover:text-primary transition-colors mb-3">
                    {post.data.title}
                  </h3>
                  <p class="text-body-base text-content-muted line-clamp-2">
                    {post.data.description}
                  </p>
                </div>
              </a>
            ))}
          </div>
        </section>
      )}
    </div>
  </div>
</BaseLayout>
