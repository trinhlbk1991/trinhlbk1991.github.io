---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';
import { SITE } from '../config';

const posts = await getCollection('blog');
const latestPosts = posts
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf())
  .slice(0, 6);
---

<BaseLayout 
  title={`Home | ${SITE.title}`}
  description={SITE.description}
>
  <div class="relative overflow-hidden">
    <!-- Decorative background element -->
    <div class="absolute -top-24 -right-24 w-96 h-96 bg-primary-light rounded-full blur-3xl opacity-30 -z-10"></div>
    
    <div class="max-w-5xl mx-auto px-6 py-24 lg:py-32">
      <!-- Hero -->
      <section class="text-center mb-24 relative">
        <span class="text-primary font-medium tracking-wider uppercase text-sm mb-4 block">
          Welcome to {SITE.title}
        </span>
        <h1 class="text-5xl md:text-6xl text-gray-900 mb-6 font-bold">
          Technical <span class="text-primary">Insights</span><br />
          for Modern Developers
        </h1>
        <p class="text-xl text-gray-600 max-w-2xl mx-auto mb-10">
          Exploring Android, iOS, frontend development, and everything in between. 
          A geek's journey through code, climbing, and continuous learning.
        </p>
        <div class="flex justify-center gap-4 flex-wrap">
          <a href="/archives" class="px-6 py-3 bg-primary text-white rounded-lg hover:bg-primary-hover transition-colors inline-flex items-center gap-2 font-medium">
            Browse Articles
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
            </svg>
          </a>
          <a href="/about" class="px-6 py-3 border-2 border-gray-300 text-gray-700 rounded-lg hover:border-primary hover:text-primary transition-colors font-medium">
            About Me
          </a>
          <a href="/search" class="px-6 py-3 border-2 border-gray-300 text-gray-700 rounded-lg hover:border-primary hover:text-primary transition-colors inline-flex items-center gap-2 font-medium">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
            </svg>
            Search
          </a>
        </div>
      </section>
  
      <!-- Latest Posts -->
      {latestPosts.length > 0 && (
        <section>
          <div class="flex items-end justify-between mb-10">
            <h2 class="text-3xl font-bold text-gray-900">Latest Articles</h2>
            <a href="/archives" class="text-primary font-medium hover:text-primary-hover transition-colors flex items-center gap-1">
              View all 
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
              </svg>
            </a>
          </div>
          
          <div class="grid gap-8 sm:grid-cols-2 lg:grid-cols-3">
            {latestPosts.map((post) => {
              const category = post.id.split('/')[0];
              const filename = post.id.split('/')[1];
              const slug = filename.replace(/^\d{4}-\d{2}-\d{2}-/, '').replace(/\.md$/, '');
              
              return (
                <article class="border border-gray-200 rounded-lg overflow-hidden hover:shadow-lg transition-shadow duration-200 group">
                  {post.data.image && (
                    <div class="aspect-[16/9] bg-gray-200 relative overflow-hidden">
                      <img 
                        src={post.data.image} 
                        alt={post.data.title}
                        class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"
                      />
                    </div>
                  )}
                  <div class="p-6">
                    <div class="flex items-center gap-3 text-sm text-gray-600 mb-3">
                      <time datetime={post.data.date.toISOString()}>
                        {post.data.date.toLocaleDateString('en-US', { 
                          year: 'numeric', 
                          month: 'short', 
                          day: 'numeric' 
                        })}
                      </time>
                      {post.data.categories && post.data.categories.length > 0 && (
                        <>
                          <span>â€¢</span>
                          <span class="px-2 py-1 bg-primary-light text-primary-hover rounded text-xs capitalize font-medium">
                            {post.data.categories[0]}
                          </span>
                        </>
                      )}
                    </div>
                    <a href={`/${category}/${slug}/`}>
                      <h3 class="text-xl font-bold text-gray-900 group-hover:text-primary transition-colors mb-3">
                        {post.data.title}
                      </h3>
                    </a>
                    {post.data.description && (
                      <p class="text-gray-600 line-clamp-2">
                        {post.data.description}
                      </p>
                    )}
                  </div>
                </article>
              );
            })}
          </div>
        </section>
      )}
    </div>
  </div>
</BaseLayout>
